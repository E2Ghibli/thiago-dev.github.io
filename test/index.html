<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Hypnomena.DUI</title>
  <meta name="description" content="hypnonema is a fivem cinema script resource">
  <meta name="author" content="">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/mediaelementplayer.min.css" integrity="sha256-ji1bfJaTGnyscoc7LzcV9yNJy5vGKJ0frO3KJo1oaGQ=" crossorigin="anonymous" />
  <!--<link href="//vjs.zencdn.net/7.6.0/video-js.css" rel="stylesheet">-->
    <style type="text/css">
        html, body, div {
            height: 100%;
          text-align: center;
          overflow: hidden;
          margin: 0;
          padding:0;
        }
        #my-video {
            width: 100vw; /*100% of horizontal viewport*/
            height:100vh; /*100% of vertical viewport*/
        }
        .video-js.vjs-paused .vjs-poster {
            display: block !important;
        }
        .video-js.vjs-ended .vjs-poster {
            display: inline-block;
        }
    </style>
</head>

<body>


        <video id='my-video' class='mejs__player' preload='none' width='100%' height='100%'
        poster='https://i.imgur.com/dPaIjEW.jpg'>
          <source src='MY_VIDEO.mp4' type='video/mp4'>
          <source src='MY_VIDEO.webm' type='video/webm'>
          <p class='vjs-no-js'>
            To view this video please enable JavaScript, and consider upgrading to a web browser that
            <a href='https://videojs.com/html5-video-support/' target='_blank'>supports HTML5 video</a>
          </p>
        </video>
  
        <!-- Player includes -->
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/mediaelement-and-player.min.js" integrity="sha256-z7JbZVaNbNzLvOCFHUNrjqnZRojZbRAxgr4KU2qL0qc=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/renderers/dailymotion.min.js" integrity="sha256-CKrsh5uD7HLCSn4/PcZuSDs7d3MrvZ6nGqidwyK3oMk=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/renderers/facebook.min.js" integrity="sha256-xFjU+e7BzCqDdOkjs/yVU3Nw6WYiWFcj8oHIfX1arEA=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/renderers/soundcloud.min.js" integrity="sha256-sGpYkPdJd2l7mdbqGqdm3v98V/tMtixHZ4BHjA8FMBQ=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/renderers/twitch.min.js" integrity="sha256-LbUp3oTMmal3EuD0oIm5WkcTTx68t9K9k9kOIwPZGsY=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/mediaelement/4.2.12/renderers/vimeo.min.js" integrity="sha256-/mDIPKyxQNNKJmBD685EjPbepZszfrWdq7rS6rbZvgY=" crossorigin="anonymous"></script>
        
        <!--
        <script src="//cdnjs.cloudflare.com/ajax/libs/video.js/7.6.0/video.js" integrity="sha256-7lzgCgLtTkrv/wfhKOA51KlXkKCZfysuQHF5Vh711Ew=" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/videojs-youtube/2.6.0/Youtube.min.js" integrity="sha256-YJbYbf82My5W9mjSfNyUOnnhafQPNI/3b0wt3rFL/es=" crossorigin="anonymous"></script>-->
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  
        <script>
            var interval = 10000;
            var splash_image = 'https://i.imgur.com/dPaIjEW.jpg';
            var pause_image = 'https://i.imgur.com/aoz9sJn.jpg';

            /*
             * DONT CHANGE variable below!
             */
            var replay = false;
            var player = new MediaElementPlayer('my-video', {
                // When using `MediaElementPlayer`, an `instance` argument
	            // is available in the `success` callback
		        success: function(mediaElement, originalNode, instance) {
                    // do things
                    instance.showPosterWhenEnded = true;
                    instance.showPosterWhenPaused = true;
                    instance.hideVideoControlsOnLoad = true;
                    instance.hideVideoControlsOnPause = true;

                    setInterval(function() {
                        if(!instance.paused) {
                            fetch('https://hypnonema/Hypnonema.StateTick', {
                                headers: {'content-type': 'application/json; charset=UTF-8'},
                            body: JSON.stringify({
                                paused: instance.paused,
                                currentTime: instance.currentTime,
                                duration: instance.duration,
                                remainingTime: instance.duration - instance.currentTime,
                                currentSource: instance.getSrc(),
                                currentType: instance.getSrc().type,
                            }),
                            method: 'POST'
                        }).catch(error => console.log(error));
                        }
                    }, interval);

                    }
                });
            /*
            var player = videojs('my-video');
            player.ready(function() {
                player.poster(splash_image);

                setInterval(function() {
                    if(!player.paused()) {
                        fetch('https://hypnonema/Hypnonema.StateTick', {
                            headers: {'content-type': 'application/json; charset=UTF-8'},
                            body: JSON.stringify({
                                paused: player.paused(),
                                currentTime: player.currentTime(),
                                duration: player.duration(),
                                remainingTime: player.remainingTime(),
                                currentSource: player.currentSource().src,
                                currentType: player.currentType(),
                            }),
                            method: 'POST'
                        }).catch(error => console.log(error));
                    }
                }, interval);
            });
            player.on('ended', function () {
                player.currentTime(0);
                player.controlBar.hide();
                if(replay) {
                    player.play();
                }
            });*/
            $(window).on('message', function ($event) {
                if(event.data.type === 'play') {
                    if(event.data.src.type === 'auto') {
                        player.src = {src: event.data.src.url};
                    } else {
                        player.src = {type: event.data.src.type, src: event.data.src.url};
                    }
                    player.load();
                    player.play();
                }

                if(event.data.type === 'update') {
                    player.src({type: event.data.src.type, src: event.data.src.url})
                    player.load();
                    player.setCurrentTime(event.data.currentTime);
                    player.play();
                }

                if(event.data.type === 'pause') {
                    player.setPoster(pause_image);
                    player.pause();
                }

                if(event.data.type === 'stop') {
                    player.pause();
                    player.setPoster(splash_image);
                    player.setCurrentTime(0);
                }

                if(event.data.type === 'resume') {
                    player.setPoster(splash_image);
                    player.play();
                }

                if(event.data.type === 'volume') {
                    player.setVolume(event.data.volume);
                }

                if(event.data.type === 'toggleReplay') {
                    replay = event.data.value;
                }

                /*
                    For twitch.tv videos with mature content 
                 */
                if(event.data.type === 'confirm') {
                    $('#mature-link').click(function() {
                        console.log('confirmed play..')
                    });
                }
            });
        </script>
</body>
</html>